#
# --- Configuració Bàsica (Ja definida al Dockerfile/Compose, però pot estar aquí) ---
# NODE_ENV production o development
NODE_ENV=development
RUN_MIGRATIONS=true
TZ=Europe/Madrid
COMPOSE_PROJECT_NAME=nodus-adk
PORT=5000
SERVER_NAME=
# --- Connexió a la Base de Dades (Credencials per a PostgreSQL) ---
# Aquests valors s'utilitzaran per construir DATABASE_URL
POSTGRES_USER=nodus
POSTGRES_PASSWORD=nodus_dev_password
POSTGRES_DB=nodus
POSTGRES_PORT=5432
DATABASE_URL=
# DATABASE_URL complet (construït automàticament al compose si s'utilitzen les variables de dalt)
# O pots definir-lo manualment aquí:
#DATABASE_URL=postgresql://sug_user:sug_password@localhost:5432/neondb
# Infisical Database (separate credentials)
INFISICAL_DB_HOST=
INFISICAL_DB_PORT=
INFISICAL_DB_NAME=
INFISICAL_DB_USER=
INFISICAL_DB_PASSWORD=
#
# --- INFISICAL CONFIGURATION ---
# Entorn on recuperar els secrets d'Infisical.
# Mana la taula app_secrets_handle. Si no està informada s'utilitza aquesta variable
# Environment: dev, stg, or prod. This is the default environment for all secrets.
# Individual secrets can override this via app_secret_handles.environment in the database.
# dev || stg || prod
INFISICAL_ENVIRONMENT=
#
# ENCRYPTION_KEY: Hexadecimal string of 16 bytes (32 characters). Generate with: openssl rand -hex 16
INFISICAL_ENCRYPTION_KEY=
# AUTH_SECRET: Base64 string of 32 bytes (44 characters). Generate with: openssl rand -base64 32
INFISICAL_AUTH_SECRET=
# PROJECT_ID és el codi de projecte que s'obté directament de l'app infisical: http://localhost:8081
INFISICAL_PROJECT_ID=

# --- Espai de disc d'emmagatzemament per la knoledge_base ---
# Opcions: gdrive o local STORAGE_MODE es defineix a la BDD, taula setting
STORAGE_MODE=local
GOOGLE_DRIVE_FOLDER_ID=
SERVICE_ACCOUNT_KEY=
STORAGE_QUOTA=
STORAGE_FOLDER_OWNER=
STORAGE_FOLDER=
# --- Connexió a Qdrant ---
# Requerit: URL del teu Qdrant extern
QDRANT_URL=http://qdrant:6333
# Opcional: Clau API del teu Qdrant (si en tens)
QDRANT_API_KEY=
QDRANT_VECTOR_SIZE=1536
QDRANT_DISTANCE=Cosine

# Collection configuration
QDRANT_COLLECTION=
QDRANT_COLLECTION_NAME=
QDRANT_COLLECTION_COMMON=
QDRANT_COLLECTION_USER_PREFIX=
QDRANT_COLLECTION_CONVERSATIONS=
# CHUNK_OVERLAP controla el nombre de caràcters que es solapen entre el final d'un chunk i l'inici del següent.
# Això ajuda a mantenir el context entre fragments consecutius.
# Exemple: Si CHUNK_MAX_SIZE=1500 i CHUNK_OVERLAP=300, cada chunk tindrà 1500 caràcters i els últims 300 caràcters
# d'un chunk seran també els primers 300 del següent.
CHUNK_MAX_SIZE=1500
CHUNK_OVERLAP=300
# Actualització de la base de dades: hour, daily, weekly, monthly
KNOWLEDGE_BASE_SCHEDULE=daily
#
# --- LLM MODEL = groq || openai || anthropic ---
#
LLM_PROVIDER=groq
LLM_MODEL=llama3-70b-8192
#
# --- OpenAI ---
# Opcions: gpt-4o (habitual) gpt-3.5-turbo (mé seconòmic) gpt-4 gpt-4-turbo (més potents i cars)
#AI_AGENT_URL=https://agent_extern:8888 # Podem fer una crida via endpoint a un agent extern
OPENAI_MODEL=
OPENAI_API_KEY=
#OPENAI_API_KEY=sk-proj-api_key
EMBEDDING_PROVIDER=
DEFAULT_EMBEDDING_MODEL=
# --- GROQ ---
GROQ_API_KEY=
#GROQ_API_KEY=gsk_api_key
# Opcions:
# llama-3.1-8b-instant - Més ràpid, menys capaç
# llama-3.1-70b-versatile - Equilibrat (recomanat)
# mixtral-8x7b-32768 - Context llarg
# llama-3.1-405b-reasoning - Més capaç (si disponible)
GROQ_MODEL=
#GROQ_MODEL=openai/gpt-oss-120b # Màxim 16384 tokens, no compatible amb SERPER
# --- Anthropic Configuration ---
ANTHROPIC_API_KEY=
#ANTHROPIC_MODEL=claude-3-5-haiku-20241022
#ANTHROPIC_MODEL=claude-3-5-sonnet-20241022
ANTHROPIC_MODEL=

# ================================
# LANGFUSE OBSERVABILITY (Self-hosted)
# ================================
LANGFUSE_HOST=http://langfuse:3000
LANGFUSE_PUBLIC_KEY=
LANGFUSE_SECRET_KEY=
OBS_SAMPLE_SUCCESS=
OBS_SAMPLE_ERROR=

# ================================
# LangSmith (compatible amb LangGraph)
# ================================
LANGSMITH_API_KEY=
LANGCHAIN_API_KEY=
LANGCHAIN_TRACING_V2=
LANGCHAIN_PROJECT=

#--------- AUDIO SECTION --------
# STT provider (openai, groq)
STT_PROVIDER=
# OpenAI STT
STT_OPENAI_ENDPOINT=
STT_OPENAI_MODEL=
STT_OPENAI_SECRET_HANDLE=
# Groq STT
STT_GROQ_ENDPOINT=
STT_GROQ_MODEL=
STT_GROQ_SECRET_HANDLE=
# Ajustos comuns
STT_MAX_DURATION=
AUDIO_MAX_DURATION=
# --- twilio o meta (per WhatsApp/SMS) ---
WHATSAPP_PROVIDER=
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_PHONE_NUMBER=
# --- Correu electrònic ---
# Email Integration: smtp (per SMTP/IMAP) o gmail (per configuració comptes Google)
EMAIL_INTEGRATION=
EMAIL_DEBUG_MODE=
# Obsolet?
#SMTP_PROVIDER=sendgrid
SMTP_PROVIDER=
# Paràmetres SMTP/IMAP
IMAP_AUTO_POLLING=
# Interval en segons per consultar la recepció de mails
# Els obtenim de la BDD perquè sigui configurable per l'usuari
#IMAP_CHECK_INTERVAL=300
#IMAP_POLLING_INTERVAL=180
#REPLY_TO_EMAIL=nodus.social@gmail.com
EMAIL_FROM=
#FROM_EMAIL=nodus.social@gmail.com
EMAIL_REPLY_TO=
SMTP_HOST=
SMTP_PORT=
SMTP_USER=
SMTP_SECURE=
SMTP_PASSWORD=
IMAP_HOST=
IMAP_PORT=
IMAP_SECURE=
IMAP_TLS=
IMAP_USER=
IMAP_PASSWORD=
# Aquest paràmetre ha de ser configurable des de l'aplicació
#FROM_NAME=Assistent IA
# Google Mail API
GMAIL_EMAIL=
GMAIL_CLIENT_ID=
GMAIL_CLIENT_SECRET=
GMAIL_REFRESH_TOKEN=
#GMAIL_OAUTH_REDIRECT_URI=https://your-app.repl.co/api/auth/gmail/callback
GMAIL_OAUTH_REDIRECT_URI=
GMAIL_OAUTH_CLIENT_ID=
# ... (Afegeix qualsevol altra variable d'entorn/secret que necessitis) ...
# Exemple:
# SENDGRID_API_KEY=
# ALTRE_SECRET=
# Serper API for real-time search
SERPER_API_KEY=
SERPER_RESULT_LIMIT=
# === AVATAR / HEYGEN (Proxy) ===
#HEYGEN_API_KEY=MmRiMWEwNTNkNmI1NGIxYTk3ZDYxNmM2NDE0Njk4NjgtMTc1NjQ2NTk0MQ== # SERGI
#HEYGEN_API_KEY=ZmJjMjJjZDgyMzExNDQzOWE4ZGVkYWU4MDIwZTI2ZTItMTc1ODcwMzM2OA== # ALBERT
HEYGEN_API_KEY=
#AVATAR_DEFAULT_ID=default
#AVATAR_DEFAULT_ID=Alessandra_CasualLook_public
#AVATAR_DEFAULT_ID=Anastasia_ProfessionalLook2_public
AVATAR_DEFAULT_ID=
AVATAR_DEFAULT_VOICE_ID=
AVATAR_DEFAULT_LANG=
# Control d’orígens (on es pot embedir el widget i qui pot demanar tokens)
ALLOWED_ORIGINS=
# Rate limiting del endpoint de token
HEYGEN_TOKEN_RPM=
HEYGEN_TOKEN_BURST=
# Ports dels nous serveis (si els exposes al compose)
AVATAR_PROXY_PORT=
AVATAR_WIDGET_PORT=
# BLOC INCLÓS A docker-compose.yml, bloc environment
# === Widget (Frontend embeddable) ===
# URL pública on es servirà l’iframe del widget
#WIDGET_PUBLIC_URL=https://legal.mycompanion.es/avatar
# URL del vostre backend existent de xat (des de el widget)
# - Si el widget s’executa dins la mateixa xarxa de Docker: http://app:5000/chat
# - Si el widget és públic en un domini diferent: https://app.vostre.com/chat
#BACKEND_CHAT_URL=https://legal.mycompanion.es/chat
# Ruta del proxy que genera tokens efímers de Heygen (accessible pel widget)
# - Si comparteixen xarxa de Docker: http://avatar-proxy:8081/api/heygen/token
# - Si és públic: https://widget-api.example.com/api/heygen/token
#HEYGEN_TOKEN_URL=https://legal.mycompanion.es/api/heygen/token
# Preferències de parla (opcional, per defecte del widget)
AVATAR_TASK_MODE=
JITTER_BUFFER_TARGET_MS=
# Telemetria i logs (opcional)
LOG_LEVEL=info
LOG_FORMAT=
# === Embedding opcional amb signatura (si vols limitar per tenant i origen) ===
# Si habilites JWT per autoritzar l’embed
WIDGET_JWT_SECRET=
WIDGET_JWT_TTL=
SERPER_ENABLED=
#SERPER_DUAL_PASS=true
#SERPER_HINT_STRICT=true # per fer el guardra   il més o menys restrictiu en el prompt
CONVERSATION_CONTEXT_LIMIT=
# Activa la vista de selecció de col·leccions a /knowledge i /chat
MULTI_COLLECTIONS_ENABLED=
# OCR per poder vectoritzar pdfs i imatges que contenen text
# Utilitzem PaddleOCR més OpenCV per preprocessar
OCR_ENABLED=
OCR_LANG=
OCR_ENDPOINT=
OCR_TOKEN=
# Regles aplicades (en ordre):
# 1) Si quasi sense text global (<50 chars) ⇒ OCR directe.
# 2) Si avgCharsPerPage < OCR_PDF_MIN_CHARS_PER_PAGE ⇒ OCR.
# 3) Si lowTextRatio ≥ OCR_PDF_LOW_TEXT_PAGE_FRACTION (usant OCR_PDF_LOW_TEXT_PER_PAGE) ⇒ OCR.
OCR_PDF_MIN_CHARS_PER_PAGE=
OCR_PDF_LOW_TEXT_PER_PAGE=
OCR_PDF_LOW_TEXT_PAGE_FRACTION=
OCR_PREPROCESS=
OCR_PDF_RASTERIZER=
OCR_PREPROCESS_STRENGTH=
OCR_PDF_SCALE=
# Gestió de secrets
INFISICAL_IMAGE_TAG=
# Tenència (E9-I2)
TENANT_CLAIM=
ALLOW_DEFAULT_TENANT=
# Redis (backends multi-tenant)
#REDIS_URL=redis://backoffice-redis:6379/0
# MinIO/S3 per checkpoints (lg-api)
S3_ENDPOINT_URL=
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
CHECKPOINT_S3_BUCKET=

# ================================
# MINIO/S3 CONFIGURATION (Additional)
# ================================
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin
MINIO_ENDPOINT=
S3_ENDPOINT=
S3_ACCESS_KEY=
S3_SECRET_KEY=
S3_BUCKET=
S3_REGION=
# Llibreta
POSTGRES_DB_LLIBRETA=
# E9-I3
#LG_API_BASE=http://localhost:8000 # URL pública de l’API per al validatori
TENANT_TEST=
# E11-I1
HMAC_FALLBACK_SECRET=
HMAC_TOLERANCE_MS=
REDIS_URL=
LG_API_BASE=
# E12-I2 Builder JWT config
JWT_ISSUER=
JWT_AUDIENCE=
JWT_TTL_SECONDS=
# Optional (not used yet)
REFRESH_TTL_SECONDS=
JWKS_ROTATE_CRON=

# ================================
# BACKOFFICE/COFIS INTEGRATION
# ================================
BACKOFFICE_URL=

# ================================
# ADK RUNTIME CONFIGURATION
# ================================
ADK_RUNTIME_URL=
ADK_PROJECT_ID=
ADK_MODEL=gpt-4o
GOOGLE_API_KEY=
GOOGLE_APPLICATION_CREDENTIALS=

# ================================
# MCP GATEWAY CONFIGURATION
# ================================
MCP_GATEWAY_URL=
MCP_ALLOWLIST_DOMAINS=
MCP_RATE_LIMIT=
MCP_BURST_LIMIT=

# ================================
# SERVICE URLS (internal)
# ================================
LG_SCHEDULER_BASE=
LG_WORKER_BASE=

# ================================
# FRONTEND CONFIGURATION
# ================================
VITE_DOCU_COMPANION_API_URL=
VITE_MCP_URL=

# ================================
# MONITORING
# ================================
PROMETHEUS_ENABLE=
GRAFANA_ADMIN_PASSWORD=

# ================================
# SECURITY
# ================================
CORS_ORIGINS=http://localhost:5002,http://localhost:5001,http://localhost:3000
TRUSTED_PROXIES=

# ================================
# RESOURCE LIMITS
# ================================
WORKER_REPLICAS=
WORKER_MEMORY_LIMIT=
WORKER_CPU_LIMIT=

# ================================
# HEALTH CHECK CONFIGURATION
# ================================
HEALTH_CHECK_INTERVAL=
HEALTH_CHECK_TIMEOUT=
HEALTH_CHECK_RETRIES=

#--- MCP SERVER GOOGLE WORKSPACE ---
BACKOFFICE_SERVICE_TOKEN=
GOOGLE_WORKSPACE_SA_CLIENT_EMAIL=
GOOGLE_WORKSPACE_SA_PRIVATE_KEY=

# ================================
# LLIBRETA CONFIGURATION
# ================================
JWT_PUBLIC_KEY=
JWT_ALGORITHM=

#--- GOOGLE SSO ---
GOOGLEWS_ALLOWED_DOMAINS=
GOOGLE_OAUTH_CLIENT_ID=
GOOGLE_OAUTH_CLIENT_SECRET=
BACKOFFICE_PUBLIC_URL=

# PERSONAL ASSISTANT
ENABLE_PERSONAL_ASSISTANT=
PERSONAL_ASSISTANT_ENGINE=adk

LG_API_URL=